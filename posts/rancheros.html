<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Khurram Aziz - RancherOS</title>

  <link rel="canonical" href='/posts/rancheros'>

      <link type="application/rss+xml" rel="alternate" title="Khurram Aziz" href="/feed.rss" />
      <link type="application/atom+xml" rel="alternate" title="Khurram Aziz" href="/feed.atom" />

  <meta name="application-name" content='Khurram Aziz' />
  <meta name="msapplication-tooltip" content='Khurram Aziz' />
  <meta name="msapplication-starturl" content='/' />

  <meta property="og:title" content='Khurram Aziz - RancherOS' />
  <meta property="og:type" content="website" />
  <meta property="og:url" content='/posts/rancheros' />

  <link rel="icon" href='/favicon.ico'>

  <!-- Custom fonts for this template -->
  <link href='/vendor/fontawesome-free/css/all.min.css' rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" data-no-mirror>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" data-no-mirror>

  <!-- Styles for this template (also includes Bootstrap) -->
  <link href='/scss/clean-blog.css' rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.3.0/dist/quicklink.umd.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet">

  


  

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href='/'>Khurram Aziz</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ms-auto">
          <li class="nav-item">
    <a class="nav-link" href="/pages/about">About</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/pages/series">Series</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/posts">Posts</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tags">Tags</a>
  </li>

      </ul>
    </div>
  </div>
</nav>


  <!-- Page Header -->
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8XSZL03B8G"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-8XSZL03B8G');
  </script>

<header class="masthead no-image">
  <div class="container position-relative">
    <div class="row">
      <div class="col-md-12">
        <div class='post-heading'>
          <h1>
            RancherOS
          </h1>
            <div class="meta">Published on Saturday, July 23, 2016</div>
              <div class="mt-3">
                  <a href="/tags/docker" class="badge text-bg-light"> Docker</a>
                  <a href="/tags/linux" class="badge text-bg-light"> Linux</a>
                  <a href="/tags/raspberry-pi" class="badge text-bg-light"> Raspberry Pi</a>
                  <a href="/tags/system-administration" class="badge text-bg-light"> System Administration</a>
              </div>
        </div>
      </div>
    </div>
  </div>
</header>


  <!-- Main Content -->
  <div class="container">
    <div class="row">
      <div id="content" class="col-md-12">
        <h2>Rancher Series</h2>    <ul>     <li>Part 1: <a title="RancherOS" href="rancheros.html">RancherOS</a></li>        <li>Part 2: <a title="Rancher–First Application" href="rancher-first-application.html">Rancher–First Application</a></li>        <li>Part 3: <a title="Rancher Infrastructure Services" href="rancher-infrastructure-services.html">Rancher Infrastructure Services</a></li>        <li>Part 4: <a title="Floating IP and Containers" href="floating-ip-and-containers.html">Floating IP and Containers</a></li>   </ul>      <p>Containers in general and Docker Containers in particular are becoming popular everyday mainly because they allow us to have a componentized environment to run the applications and host them on premises or in cloud seamlessly. Containers are portable and simple; vendors are adding new features to allow us to create scalable container environments. Containerizing a simple application following Micro-Service Architecture and then making it scalable and high available; things become complex very quickly; managing and running these application becomes daunting. “Container Orchestration Tools” becomes necessity for Production Environments. These tools provide multi-host / cluster aware container manageability, assist in mitigating security and networking issues and provide services that are needed to scale the applications.</p>    <p>Docker has introduced Swarm recently that’s coming in next release, it’s an orchestration platform and being “in the box” will play an important role. Google’s Kubernetes is currently leading but it’s suited for large cloud environment. Its complex and overkill for enterprise and on premises cloud environments. Apache’s Mesos is another option but it’s not just Container Orchestration Tool; it’s designed for general datacenter management. It’s good to know and learn about these tools and what common features they provide so we the developers can assist our system administrators in keeping our application running in the production environment but using the features and services these tools provide can design and develop cloud aware applications by not reinventing the wheel. This series will be about Rancher, its very user friendly, very little learning curve, provide features and services of any modern Container Orchestration Tool and most importantly can be setup on a typical single laptop based development environment.</p>      <p>Rancher comes in two flavors; its a Docker Container available at Docker Hub that you can run on any Docker host; and in its second offering; its a&nbsp;Linux&nbsp;distribution designed especially to run Docker Containers, very similar to Boot2Docker.&nbsp;The distinguishing thing about the RancherOS is that the OS itself runs everything in the Containers.    <br><img width="399" height="250" title="rancheros-docker-kernel[1]" style="border-left-width:0px;border-right-width:0px;background-image:none;border-bottom-width:0px;float:none;padding-top:0px;padding-left:0px;margin:10px auto 0px;display:block;padding-right:0px;border-top-width:0px;" alt="rancheros-docker-kernel[1]" src="/images/RancherOS_C158/rancheros-docker-kernel1.png" border="0"></p>      <p>Rancher provides the network, storage, load balancer and DNS services. It provides Docker Swarn, Kubernetes and Mesos orchestration along with its own implementation. It has application cataloging features and other enterprise grade required features.</p>      <p><img width="601" height="250" style="float:none;margin:10px auto 0px;display:block;" alt="Rancher Overview" src="http://docs.rancher.com/img/rancher/rancher_overview_2.png"></p>      <p>To set it up, you will need Git Tools installed on your Windows machine, and you will also need Linux friendly editor like Visual Studio Code and Putty’s PSCP tool.</p>      <p>Using Git Shell; create the SSH key using ssh-keygen; it will create id-rsa and id_rsa.pub file. Using the editor; create a cloud-config.yml that will have your public ssh-key from id_rsa.pub file as shown the picture below.</p>      <p><img width="1211" height="564" title="image" style="border-left-width:0px;border-right-width:0px;background-image:none;border-bottom-width:0px;padding-top:0px;padding-left:0px;margin:10px 10px 0px 0px;display:inline;padding-right:0px;border-top-width:0px;" alt="image" src="/images/RancherOS_C158/image.png" border="0"></p>      <p>Once the yml file is&nbsp;made with all&nbsp;the required network infrastructure details; we can mount the ISO in the new virtual machine or some physical machine; and boot RancherOS. ISO is available at <a title="https://github.com/rancher/os" href="https://github.com/rancher/os">https://github.com/rancher/os</a> When machine is booted up; simply copy the cloud.config.yml using PSCP (from Putty) to the Rancher Machine. SSH your Rancher machine and issue <b>sudo ros install -c cloud-config.yml -d /dev/sda</b> command and it will download the latest files and install the OS</p>      <p><img width="915" height="366" title="image" style="border-left-width:0px;border-right-width:0px;background-image:none;border-bottom-width:0px;padding-top:0px;padding-left:0px;margin:10px 10px 0px 0px;display:inline;padding-right:0px;border-top-width:0px;" alt="image" src="/images/RancherOS_C158/image_3.png" border="0"></p>      <p>After an install and reboot;&nbsp;we will have the&nbsp;RancherOS running and we can&nbsp;SSH&nbsp;it&nbsp;from Git Shell using ssh rancher&#64;ip. Its just an OS having an ability to run the Docker Containers. We still need to run the rancher container using <b>sudo docker run –d –restart=always –p 8080:8080 rancher/server</b> and when the Rancher Container is running;&nbsp;we can access its GUI at <a href="http://YourRancherMachine:8080">http://YourRancherMachine:8080</a></p>      <p><img width="894" height="435" title="image" style="border-left-width:0px;border-right-width:0px;background-image:none;border-bottom-width:0px;padding-top:0px;padding-left:0px;margin:10px 10px 0px 0px;display:inline;padding-right:0px;border-top-width:0px;" alt="image" src="/images/RancherOS_C158/image_4.png" border="0"></p>      <p>You can view system level containers running in RancherOS using system-docker and user level containers using traditional docker binary</p>      <p><img width="995" height="282" title="image" style="border-left-width:0px;border-right-width:0px;background-image:none;border-bottom-width:0px;padding-top:0px;padding-left:0px;margin:10px 10px 0px 0px;display:inline;padding-right:0px;border-top-width:0px;" alt="image" src="/images/RancherOS_C158/image_7.png" border="0"></p>      <p>Rancher has concept of hosts; the nodes that act will run the Containers; you need more machines acting as hosts; you add Hosts from Infrastructure option. Typically some Hosts will have Live IPs where you will deploy your public facing apps and some will have internal IPs; its better to have multiple NICs (Network Interfaces) on the Rancher Server machine; you can setup networking in RancherOS using ros config; and for multiple NICs use <b>ros config set rancher.network.interfaces.”mac=11:22:33:44:55:66”</b>; for static ip the commands will be</p>      <blockquote>     <p><font face="Courier New">sudo ros config set rancher.network.interfaces.”mac=11:22:33:44:55:66”.dhcp false        <br>sudo ros config set rancher.network.interfaces.”mac=11:22:33:44:55:66”.gateway 1.1.1.1         <br>sudo ros config set rancher.network.interfaces.”mac=11:22:33:44:55:66”.address 1.1.1.2/24</font></p>   </blockquote>      <p>When we click Add Host button; it gives us the docker run command that we need to run on the node</p>      <p><img width="791" height="277" title="image" style="border-left-width:0px;border-right-width:0px;background-image:none;border-bottom-width:0px;padding-top:0px;padding-left:0px;margin:10px 10px 0px 0px;display:inline;padding-right:0px;border-top-width:0px;" alt="image" src="/images/RancherOS_C158/image_5.png" border="0"></p>      <p>For the Hosts; rancher/agent Docker container runs on the host, that can be run on the machine that has the Docker installed + configured; it can be any Docker compatible Linux Machine (Physical or VM) . We can use RancherOS as well for the hosts. Its recommended not to use Rancher Server machine as agent; as few components of Rancher Server are made in Java; and you know it needs more resources <img class="wlEmoticon wlEmoticon-smile" style="border-top-style:none;border-left-style:none;border-bottom-style:none;border-right-style:none;" alt="Smile" src="/images/RancherOS_C158/wlEmoticon-smile.png"> I created two separate VMs for the hosts and running rancher/agent containers using the commands it asks; they appear shortly in the Infrastructure &gt; Hosts</p>      <p><img width="677" height="374" title="image" style="border-left-width:0px;border-right-width:0px;background-image:none;border-bottom-width:0px;padding-top:0px;padding-left:0px;margin:10px 10px 0px 0px;display:inline;padding-right:0px;border-top-width:0px;" alt="image" src="/images/RancherOS_C158/image_8.png" border="0"></p>      <p>Theoretically Raspberry Pi can also act as a "Host"; we can use Raspbian and install Docker (Hypriot prepared Docker deb files as discussed in <a title="Docker on Raspberry Pi" href="/posts/raspberry-pi-docker.html">Docker on Raspberry Pi</a> post) and use it;&nbsp;we can use especially made OS/image for Raspberry that has Docker,&nbsp;like the one from Hypriot; or we can use RancherOS that also comes for Raspberry PI.</p>      <p><img width="640" height="360" title="image" style="border-left-width:0px;border-right-width:0px;background-image:none;border-bottom-width:0px;float:none;padding-top:0px;padding-left:0px;margin:10px auto 0px;display:inline;padding-right:0px;border-top-width:0px;" alt="image" src="/images/RancherOS_C158/image_6.png" border="0"></p>      <ul>     <li>I tried RancherOS on PI; but it was giving weird errors when installing; came to know it was because the memory card I was using was fast <img class="wlEmoticon wlEmoticon-smile" style="border-top-style:none;border-left-style:none;border-bottom-style:none;border-right-style:none;" alt="Smile" src="/images/RancherOS_C158/wlEmoticon-smile.png"> so found an old card and used it instead and it installed fine.</li>        <li>Sadly it doesn't extend the partition and doesn't use the complete available storage of the card. You have to use <a href="http://gparted.sourceforge.net" target="_blank">GPARTED</a> to extend the partition.</li>        <li>There’s no cloud-config.yml to install ROS; instead its offered as memory card image; to set static ip on RancherOS machine; use <b>sudo ros config set rancher.network.interfaces.eth1.address "192.168.10.21/24"</b> followed by <b>sudo system-docker restart network</b> (or reboot) </li>        <li>Raspberry Pi is ARM; we cant run / orchestrate x86/x64 containers on Pis; we need ARM images instead </li>        <li>Sadly there is no prebuilt ARM rancher/agent container; that needs to run so the PI get listed in Hosts and can be used for orchestration; we need to compile it from source</li>        <li>Rancher Server currently cant be compiled on Raspberry Pi; we can only use PIs as hosts / agents; it would be great to have PIs only Rancher&nbsp;Cluster</li>   </ul>      <p>You can follow these Github Urls for the updates</p>      <ul>     <li><a title="https://github.com/rancher/rancher/issues/4703" href="https://github.com/rancher/rancher/issues/4703">https://github.com/rancher/rancher/issues/4703</a></li>        <li><a title="https://github.com/rancher/agent-instance/pull/18" href="https://github.com/rancher/agent-instance/pull/18">https://github.com/rancher/agent-instance/pull/18</a></li>   </ul>


        

      </div>
    </div>
  </div>

  <hr>

  <!-- Footer -->
  <footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12 text-center">
        <p class="copyright">Copyright &#xA9; 2024</p>

        <ul class="list-inline text-center small">
            <li class="list-inline-item">
              <a href="/feed.rss"><i class="fa fa-rss"></i> RSS Feed</a>
            </li>
            <li class="list-inline-item">
              <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
            </li>
        </ul>
        <br />
        <div class="font-weight-bold small"><a href="https://statiq.dev">Generated by Statiq</a></div>
      </div>
    </div>
  </div>
</footer>


  <!-- Scripts -->
  <script src='/vendor/bootstrap/js/bootstrap.bundle.min.js'></script>
  <script src='/vendor/startbootstrap-clean-blog/js/scripts.js'></script>
  <script src='/js/clean-blog.js'></script>
  

  

</body>

</html>
