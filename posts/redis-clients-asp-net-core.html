<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Khurram Aziz - Redis Clients - ASP.NET Core</title>

  <link rel="canonical" href='/posts/redis-clients-asp-net-core'>

      <link type="application/rss+xml" rel="alternate" title="Khurram Aziz" href="/feed.rss" />
      <link type="application/atom+xml" rel="alternate" title="Khurram Aziz" href="/feed.atom" />

  <meta name="application-name" content='Khurram Aziz' />
  <meta name="msapplication-tooltip" content='Khurram Aziz' />
  <meta name="msapplication-starturl" content='/' />

  <meta property="og:title" content='Khurram Aziz - Redis Clients - ASP.NET Core' />
  <meta property="og:type" content="website" />
  <meta property="og:url" content='/posts/redis-clients-asp-net-core' />

  <link rel="icon" href='/favicon.ico'>

  <!-- Custom fonts for this template -->
  <link href='/vendor/fontawesome-free/css/all.min.css' rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" data-no-mirror>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" data-no-mirror>

  <!-- Styles for this template (also includes Bootstrap) -->
  <link href='/scss/clean-blog.css' rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.3.0/dist/quicklink.umd.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet">

  


  

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href='/'>Khurram Aziz</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ms-auto">
          <li class="nav-item">
    <a class="nav-link" href="/pages/about">About</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/pages/series">Series</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/posts">Posts</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tags">Tags</a>
  </li>

      </ul>
    </div>
  </div>
</nav>


  <!-- Page Header -->
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8XSZL03B8G"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-8XSZL03B8G');
  </script>

<header class="masthead no-image">
  <div class="container position-relative">
    <div class="row">
      <div class="col-md-12">
        <div class='post-heading'>
          <h1>
            Redis Clients - ASP.NET Core
          </h1>
            <div class="meta">Published on Sunday, March 19, 2017</div>
              <div class="mt-3">
                  <a href="/tags/net" class="badge text-bg-light"> .NET</a>
                  <a href="/tags/asp.net" class="badge text-bg-light"> ASP.NET</a>
                  <a href="/tags/databases" class="badge text-bg-light"> Databases</a>
              </div>
        </div>
      </div>
    </div>
  </div>
</header>


  <!-- Main Content -->
  <div class="container">
    <div class="row">
      <div id="content" class="col-md-12">
          <table cellspacing="0" cellpadding="2">        <tr>            <td>                <p><b>Redis Series</b></p>                <ul>                    <li><a href="redis.html" target="_blank">Redis</a></li>                    <li><a href="redis-clients.html" target="_blank">Redis Clients</a></li>                    <li>This Post</li>              </ul>          </td>            <td>                            <p><b>Dotnet Core Series</b></p>              <ul>                  <li><a href="dotnet-core.html" target="_blank">Dotnet Core</a></li>                  <li>This Post</li>                  <li><a href="docker-registry.html" target="_blank">Docker Registry</a></li>                  <li><a href="jenkins.html" target="_blank">Jenkins</a></li>                  <li><a href="dotnetcore-postgresql.html" target="_blank">Dotnet Core -- PostgreSQL</a></li>              </ul>            </td>      </tr>  </table>    <p>In the “Redis Clients” post; we explored what it takes to use Redis and how it can be helpful in our applications. We also utilized <a href="https://redis.io/topics/data-types-intro" target="_blank">Redis datatypes and abstractions</a> and how it can be used for page / visitor counters required in web applications. In the “Dotnet Core” post we saw that given the open source version of Dotnet now works in Linux; we can deploy the Dotnet Core applications into the Docker Containers. We even made the simple ASP.NET Core application and connect it to Redis and experienced that we can use Redis as the Distributed Cache backend using the <b>Microsoft.Extensions.Caching.Redis.Core</b> Nuget package that uses the StackExchange.Redis Redis Client library.</p>      <p>They also opened source the MVC framework and we can setup the ASP.NET Core MVC project using the Dotnet Core CLI; dotnet new mvc. We can have Middlewares; that handle the requests and responses. You can learn more about Middlewares at <a title="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/middleware" href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/middleware" target="_blank">https://docs.microsoft.com/en-us/aspnet/core/fundamentals/middleware</a> and there is a StartTimeHeader middleware at <a title="https://docs.microsoft.com/en-us/aspnet/core/performance/caching/distributed" href="https://docs.microsoft.com/en-us/aspnet/core/performance/caching/distributed" target="_blank">https://docs.microsoft.com/en-us/aspnet/core/performance/caching/distributed</a> that uses the Distributed Caching feature of ASP.NET Core and Redis as the backend. On the same lines, for the Visitor Counter using Redis that we did in “Redis Clients”; we can have a RedisVisitorMiddleware that does its counting and we can have this cross cutting concern handled separately in its own class that can be glued into the MVC application in the Startup.cs</p>   <script src="//gist-it.appspot.com/github/khurram-aziz/HelloDocker/blob/master/Redis/RedisMvc/RedisVisitorMiddleware.cs"></script>    <p>If we are using Micro Services Architecture and the final application will get deployed on Containers; the Redis Server will be running on a remote node; unfortunately we cant use the host name for Redis Cache Server and it will throw Platform Not Supported exception. We will have to resolve the host name and give its IP for the Redis Configuration in Startup.cs; we can have the static property for RedisConnection in Startup.cs; something like this</p>   <script src="https://gist.github.com/khurram-aziz/33deb321ac0b450b7881af09c2505ddc.js"></script>    <p>The hit counter code can be moved to relevant Controller / Action that can use Startup.RedisConnection static property to access Redis. We can use the same property to setup the Redis Distributed Caching provider</p>   <script src="https://gist.github.com/khurram-aziz/b7a2edb209991373c5232bf9cd0368b1.js"></script>    <p>We can use Distributed Caching for Page Caching. If there is any Page that takes considerable time to “generate” and content of that page is not dynamic or change rarely; we can use Redis to store the generated page and reuse it from there. ASP.NET Core MVC has concept of Views and Partial Views; we can use Distributed Caching to cache them; for the testing; lets setup a Partial View in ~Views/Shared/ and for proof of concept we can use Thread.Sleep emulating time that it takes to generate.</p>   <script src="//gist-it.appspot.com/github/khurram-aziz/HelloDocker/blob/master/Redis/RedisMvc/Views/Shared/PromoPartial.cshtml"></script>    <p>Tag Helpers in ASP.NET Core MVC enables server side code to participate in creating and rending HTML elements in Razor files. You can learn about them at <a title="https://docs.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/intro" href="https://docs.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/intro" target="_blank">https://docs.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/intro</a> and there is a DistributedCacheTagHelper (code &#64; <a title="https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.TagHelpers/DistributedCacheTagHelper.cs" href="https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.TagHelpers/DistributedCacheTagHelper.cs" target="_blank">https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.TagHelpers/DistributedCacheTagHelper.cs</a>) that we can use for Partial View Caching.</p>   <script src="https://gist.github.com/khurram-aziz/240ec4850abe1421364009b281bb9d5c.js"></script>    <p>Now to deploy our application into the Dockers; if we are doing it on a single host and having two containers; we will have the following v2 Compose file that we can use with Docker Compose tool</p>   <script src="http://gist-it.appspot.com/github/khurram-aziz/HelloDocker/blob/master/Redis/redis-v2.yml"></script>    <ul>     <li>If we specify the Dockerfile in the YML; we can build the required image for the MVC application with docker-compose using the –build option </li>        <li>The code of the MVC application is available at <a title="https://github.com/khurram-aziz/HelloDocker/tree/master/Redis/RedisMvc" href="https://github.com/khurram-aziz/HelloDocker/tree/master/Redis/RedisMvc" target="_blank">https://github.com/khurram-aziz/HelloDocker/tree/master/Redis/RedisMvc</a> </li>   </ul>      <p>The Dockerfile for our MVC application will be something like this:</p>   <script src="http://gist-it.appspot.com/github/khurram-aziz/HelloDocker/blob/master/Redis/RedisMvc/Dockerfile"></script>  <ul>  <li>Before building the Docker image using the above Dockerfile; we need to have the published application in the "output" folder; by running; dotnet restore (if required) and dotnet publish -c Release -o output</li>  </ul>


        

      </div>
    </div>
  </div>

  <hr>

  <!-- Footer -->
  <footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12 text-center">
        <p class="copyright">Copyright &#xA9; 2024</p>

        <ul class="list-inline text-center small">
            <li class="list-inline-item">
              <a href="/feed.rss"><i class="fa fa-rss"></i> RSS Feed</a>
            </li>
            <li class="list-inline-item">
              <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
            </li>
        </ul>
        <br />
        <div class="font-weight-bold small"><a href="https://statiq.dev">Generated by Statiq</a></div>
      </div>
    </div>
  </div>
</footer>


  <!-- Scripts -->
  <script src='/vendor/bootstrap/js/bootstrap.bundle.min.js'></script>
  <script src='/vendor/startbootstrap-clean-blog/js/scripts.js'></script>
  <script src='/js/clean-blog.js'></script>
  

  

</body>

</html>
